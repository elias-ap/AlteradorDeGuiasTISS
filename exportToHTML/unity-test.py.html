<html>
<head>
<title>unity-test.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
unity-test.py</font>
</center></td></tr></table>
<pre><span class="s0"># IMPORTS</span>
<span class="s2">import </span><span class="s1">typing</span>
<span class="s2">import </span><span class="s1">xml.etree.ElementTree </span><span class="s2">as </span><span class="s1">Et</span>
<span class="s2">import </span><span class="s1">os</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">hashlib</span>
<span class="s2">import </span><span class="s1">customtkinter </span><span class="s2">as </span><span class="s1">ctk</span>
<span class="s2">from </span><span class="s1">tkinter </span><span class="s2">import </span><span class="s1">filedialog </span><span class="s2">as </span><span class="s1">fd</span>
<span class="s2">from </span><span class="s1">tkinter </span><span class="s2">import </span><span class="s1">messagebox </span><span class="s2">as </span><span class="s1">mb</span>

<span class="s0"># SET TAG PREFIX USED AS DEFAULT BY TISS GUIDES</span>
<span class="s1">ans_prefix = {</span><span class="s3">'ans'</span><span class="s1">: </span><span class="s3">'http://www.ans.gov.br/padroes/tiss/schemas'</span><span class="s1">}</span>


<span class="s2">def </span><span class="s1">generateHashAndSave():</span>
    <span class="s1">file_type = ((</span><span class="s3">'XML files'</span><span class="s2">, </span><span class="s3">'*.xml'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">'All files'</span><span class="s2">, </span><span class="s3">'*.*'</span><span class="s1">))</span>
    <span class="s1">guides_paths = fd.askopenfilenames(filetypes=file_type)</span>
    <span class="s2">if </span><span class="s1">guides_paths != </span><span class="s3">''</span><span class="s1">:</span>
        <span class="s2">for </span><span class="s1">path </span><span class="s2">in </span><span class="s1">guides_paths:</span>
            <span class="s0"># OPEN GUIDE</span>
            <span class="s1">root_tag = getRootTagFromXML(path)</span>
            <span class="s1">generateHash(root_tag)</span>
            <span class="s1">saveFile(path)</span>

        <span class="s2">if </span><span class="s1">len(guides_paths) &gt; </span><span class="s4">1</span><span class="s1">:</span>
            <span class="s1">mb.showinfo(</span><span class="s3">'Info'</span><span class="s2">, </span><span class="s3">'Arquivos salvos!'</span><span class="s1">)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">mb.showinfo(</span><span class="s3">'Info'</span><span class="s2">, </span><span class="s3">'Arquivo salvo!'</span><span class="s1">)</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">mb.showwarning(title=</span><span class="s3">'Erro'</span><span class="s2">, </span><span class="s1">message=</span><span class="s3">'A guia não foi escolhida!'</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">openWorksheet():</span>
    <span class="s1">path = os.path.abspath(</span><span class="s3">'Sources/Teste.xlsx'</span><span class="s1">)</span>
    <span class="s1">os.startfile(</span><span class="s3">f&quot;</span><span class="s2">{</span><span class="s1">path</span><span class="s2">}</span><span class="s3">&quot;</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">openGuide():  </span><span class="s0"># path: str</span>
    <span class="s2">global </span><span class="s1">guide_path</span><span class="s2">, </span><span class="s1">root_tag</span>
    <span class="s0"># guide_path = path</span>
    <span class="s1">file_type = ((</span><span class="s3">'XML files'</span><span class="s2">, </span><span class="s3">'*.xml'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">'All files'</span><span class="s2">, </span><span class="s3">'*.*'</span><span class="s1">))</span>
    <span class="s1">guide_path = fd.askopenfilename(filetypes=file_type)</span>
    <span class="s2">if </span><span class="s1">os.path.isfile(guide_path):</span>
        <span class="s1">root_tag = getRootTagFromXML(guide_path)</span>
        <span class="s1">waitingAlterationConfig()</span>

    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">mb.showwarning(title=</span><span class="s3">'Erro'</span><span class="s2">, </span><span class="s1">message=</span><span class="s3">'A guia não foi escolhida!'</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">getRootTagFromXML(guide_path: str):</span>
    <span class="s2">global </span><span class="s1">guide_file</span>
    <span class="s1">guide_file = Et.parse(guide_path</span><span class="s2">, </span><span class="s1">parser=Et.XMLParser(encoding=</span><span class="s3">&quot;ISO-8859-1&quot;</span><span class="s1">))</span>
    <span class="s1">root_tag = guide_file.getroot()</span>
    <span class="s2">return </span><span class="s1">root_tag</span>


<span class="s2">def </span><span class="s1">waitingAlterationConfig():</span>
    <span class="s2">global </span><span class="s1">cancel_button</span><span class="s2">, </span><span class="s1">check_button_information</span><span class="s2">, </span><span class="s1">alteration_button</span><span class="s2">, </span><span class="s1">saveGuide_button</span><span class="s2">, </span><span class="s1">\</span>
        <span class="s1">data_alteration_check_button</span><span class="s2">, </span><span class="s1">value_alteration_check_button</span>

    <span class="s0"># DESTROY RELATIVE BUTTONS</span>
    <span class="s1">generateHashAndSave_button.destroy()</span>
    <span class="s1">chooseGuide_button.destroy()</span>

    <span class="s0"># BUTTONS AFTER GUIDE CHOOSE</span>
    <span class="s1">cancel_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Cancelar'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: cancelAlteration())</span>
    <span class="s1">cancel_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s1">check_button_information = ctk.CTkLabel(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Escolha os modos de alteração:'</span><span class="s1">)</span>
    <span class="s1">check_button_information.pack(side=</span><span class="s3">'top'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s1">alteration_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Realizar alterações'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: doAlterationAction())</span>
    <span class="s1">alteration_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s1">data_alteration_check_button = ctk.CTkSwitch(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Alteração de dados'</span><span class="s2">, </span><span class="s1">text_color=</span><span class="s3">'white'</span><span class="s1">)</span>
    <span class="s1">data_alteration_check_button.pack(pady=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s1">value_alteration_check_button = ctk.CTkSwitch(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Alteração de valor'</span><span class="s2">, </span><span class="s1">text_color=</span><span class="s3">'white'</span><span class="s1">)</span>
    <span class="s1">value_alteration_check_button.pack(side=</span><span class="s3">'top'</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">10</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">doAlterationAction():</span>
    <span class="s2">global </span><span class="s1">not_found_items</span><span class="s2">, </span><span class="s1">alteration_log_list</span><span class="s2">, </span><span class="s1">control_var</span>
    <span class="s1">control_var = </span><span class="s4">0</span>
    <span class="s1">alteration_log_list = []</span>
    <span class="s1">data_alteration_check = </span><span class="s4">0  </span><span class="s0"># data_alteration_check_button.get()</span>
    <span class="s1">value_alteration_check = </span><span class="s4">1  </span><span class="s0"># value_alteration_check_button.get()</span>
    <span class="s1">guide_accounts = getGuideType()</span>
    <span class="s1">not_found_items = [</span><span class="s3">f'Número de contas na guia: </span><span class="s2">{</span><span class="s1">len(guide_accounts)</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">]</span>

    <span class="s2">if </span><span class="s1">data_alteration_check == </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s1">doDataAlteration(guide_accounts)</span>

    <span class="s2">if </span><span class="s1">value_alteration_check == </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s1">doValueAlteration(guide_accounts)</span>

    <span class="s2">if </span><span class="s1">data_alteration_check == </span><span class="s4">0 </span><span class="s2">and </span><span class="s1">value_alteration_check == </span><span class="s4">0</span><span class="s1">:</span>
        <span class="s1">mb.showwarning(</span><span class="s3">'Erro'</span><span class="s2">, </span><span class="s3">'Escolha o modo de alteração'</span><span class="s1">)</span>

    <span class="s2">elif </span><span class="s1">control_var &gt; </span><span class="s4">0</span><span class="s1">:</span>
        <span class="s1">print(</span><span class="s3">f'Alterou:</span><span class="s2">{</span><span class="s1">control_var</span><span class="s2">}</span><span class="s3">'</span><span class="s1">)</span>
        <span class="s1">waitSave()</span>
        <span class="s2">global </span><span class="s1">saveGuide_button</span>
        <span class="s1">saveGuide_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Salvar Guia'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: saveGuideAfterAlterations())</span>
        <span class="s1">saveGuide_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">mb.showinfo(</span><span class="s3">'Atenção'</span><span class="s2">, </span><span class="s3">'Não foi realizada nenhuma alteração.'</span><span class="s1">)</span>

    <span class="s1">showNotFoundItems(not_found_items)</span>


<span class="s2">def </span><span class="s1">getGuideType():</span>
    <span class="s2">global </span><span class="s1">guide_type</span>
    <span class="s1">possibles_guide_type = </span><span class="s3">'{' f'</span><span class="s2">{</span><span class="s1">ans_prefix[</span><span class="s3">&quot;ans&quot;</span><span class="s1">]</span><span class="s2">}</span><span class="s3">' '}guiaSP-SADT'</span><span class="s2">, </span><span class="s3">'{' f'</span><span class="s2">{</span><span class="s1">ans_prefix[</span><span class="s3">&quot;ans&quot;</span><span class="s1">]</span><span class="s2">}</span><span class="s3">' '}guiaResumoInternacao'</span>

    <span class="s1">accounts = root_tag.iter(possibles_guide_type[</span><span class="s4">0</span><span class="s1">])</span>
    <span class="s2">if </span><span class="s1">len(list(accounts)) &gt; </span><span class="s4">0</span><span class="s1">:</span>
        <span class="s1">accounts = list(root_tag.iter(possibles_guide_type[</span><span class="s4">0</span><span class="s1">]))</span>
        <span class="s1">guide_type = </span><span class="s3">'SADT'</span>
        <span class="s2">return </span><span class="s1">accounts</span>

    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">accounts = list(root_tag.iter(possibles_guide_type[</span><span class="s4">1</span><span class="s1">]))</span>
        <span class="s1">guide_type = </span><span class="s3">'HOSPITALIZATION'</span>
        <span class="s2">return </span><span class="s1">accounts</span>


<span class="s2">def </span><span class="s1">doDataAlteration(guide_accounts: list[Et.Element]):</span>
    <span class="s0"># READ WORKSHEET TABLE OF DATA ALTERATION</span>
    <span class="s1">table_reviews = pd.read_excel(</span><span class="s3">&quot;Sources/Teste.xlsx&quot;</span><span class="s2">, </span><span class="s1">sheet_name=</span><span class="s3">'1'</span><span class="s2">, </span><span class="s1">dtype=str</span><span class="s2">, </span><span class="s1">keep_default_na=</span><span class="s2">False</span><span class="s1">)</span>

    <span class="s0"># FOR EACH REVIEW LINE IN TABLE, IF THE CONDITIONS IS ATTENDED DOES ALTERATIONS</span>
    <span class="s2">for </span><span class="s1">review_line </span><span class="s2">in </span><span class="s1">table_reviews.values:</span>
        <span class="s1">prepareDataAlteration(review_line)</span>

        <span class="s2">for </span><span class="s1">account </span><span class="s2">in </span><span class="s1">guide_accounts:</span>
            <span class="s1">specified_procedure_data = getSpecifiedProcedureData(account)</span>

            <span class="s2">if </span><span class="s1">isinstance(specified_procedure_data</span><span class="s2">, </span><span class="s1">list):</span>
                <span class="s2">for </span><span class="s1">procedure </span><span class="s2">in </span><span class="s1">specified_procedure_data:</span>
                    <span class="s1">alterTableType(procedure)</span>
                    <span class="s1">alterUnityMeasure(procedure)</span>
                    <span class="s1">alterProcedureCode(procedure)</span>
                    <span class="s1">wasAltered()</span>


<span class="s2">def </span><span class="s1">prepareDataAlteration(review_line: list):</span>
    <span class="s2">global </span><span class="s1">guide_number</span><span class="s2">, </span><span class="s1">procedure_code</span><span class="s2">, </span><span class="s1">new_procedure_code</span><span class="s2">, </span><span class="s1">table_type</span><span class="s2">, </span><span class="s1">new_table_type</span><span class="s2">, </span><span class="s1">unity_measure</span><span class="s2">, </span><span class="s1">new_unity_measure</span>
    <span class="s1">[guide_number</span><span class="s2">, </span><span class="s1">procedure_code</span><span class="s2">, </span><span class="s1">new_procedure_code</span><span class="s2">, </span><span class="s1">table_type</span><span class="s2">, </span><span class="s1">new_table_type</span><span class="s2">, </span><span class="s1">unity_measure</span><span class="s2">,</span>
     <span class="s1">new_unity_measure] = returnReviewLine(review_line</span><span class="s2">, </span><span class="s3">'data'</span><span class="s1">)</span>

    <span class="s2">if </span><span class="s1">new_table_type == </span><span class="s3">'0'</span><span class="s1">:</span>
        <span class="s1">new_table_type = str(new_table_type).replace(</span><span class="s3">'0'</span><span class="s2">, </span><span class="s3">'00'</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">returnReviewLine(review_list: list</span><span class="s2">, </span><span class="s1">mode: str):</span>
    <span class="s0"># IF DEFINED FOR DOING DATA ALTERATIONS:</span>
    <span class="s2">if </span><span class="s1">mode == </span><span class="s3">'data'</span><span class="s1">:</span>
        <span class="s2">return </span><span class="s1">review_list[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">4</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">5</span><span class="s1">]</span><span class="s2">, </span><span class="s1">\</span>
               <span class="s1">review_list[</span><span class="s4">6</span><span class="s1">]</span>

    <span class="s0"># IF DEFINED FOR DOING VALUE ALTERATIONS:</span>
    <span class="s2">if </span><span class="s1">mode == </span><span class="s3">'values'</span><span class="s1">:</span>
        <span class="s2">return </span><span class="s1">review_list[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">2</span><span class="s1">].replace(</span><span class="s3">','</span><span class="s2">, </span><span class="s3">'.'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">review_list[</span><span class="s4">3</span><span class="s1">].replace(</span><span class="s3">','</span><span class="s2">, </span><span class="s3">'.'</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">getSpecifiedProcedureData(guide_account: Et.Element):</span>
    <span class="s2">if </span><span class="s1">guide_type == </span><span class="s3">'SADT' </span><span class="s2">and </span><span class="s1">guide_number != </span><span class="s3">''</span><span class="s1">:</span>
        <span class="s1">guide_account = guide_account.find(</span><span class="s3">f'ans:cabecalhoGuia[ans:numeroGuiaPrestador=&quot;</span><span class="s2">{</span><span class="s1">guide_number</span><span class="s2">}</span><span class="s3">&quot;]..'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
        <span class="s2">if </span><span class="s1">Et.iselement(guide_account):</span>
            <span class="s1">account_executed_procedures = getExecutedProcedures(guide_account)</span>
            <span class="s1">account_expense_procedures = getExpenseProcedures(guide_account)</span>
            <span class="s1">specified_procedure = searchSpecifiedProcedureInExecutedOrExpensesProcedures(account_executed_procedures</span><span class="s2">,</span>
                                                                                         <span class="s1">account_expense_procedures)</span>

            <span class="s2">if </span><span class="s1">specified_procedure </span><span class="s2">is not None</span><span class="s1">:</span>
                <span class="s2">return </span><span class="s1">specified_procedure</span>
            <span class="s2">else</span><span class="s1">:</span>
                <span class="s1">message = </span><span class="s3">f'Procedimento: </span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">} </span><span class="s3">não foi encontrado na conta: </span><span class="s2">{</span><span class="s1">guide_number</span><span class="s2">}\n</span><span class="s3">'</span>
                <span class="s1">not_found_items.append(message)</span>

    <span class="s2">elif </span><span class="s1">guide_type == </span><span class="s3">'SADT' </span><span class="s2">or </span><span class="s1">guide_type == </span><span class="s3">'HOSPITALIZATION'</span><span class="s1">:</span>
        <span class="s1">account_executed_procedures = getExecutedProcedures(guide_account)</span>
        <span class="s1">account_expense_procedures = getExpenseProcedures(guide_account)</span>
        <span class="s1">specified_procedure = searchSpecifiedProcedureInExecutedOrExpensesProcedures(account_executed_procedures</span><span class="s2">,</span>
                                                                                     <span class="s1">account_expense_procedures)</span>
        <span class="s2">if </span><span class="s1">specified_procedure </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s2">return </span><span class="s1">specified_procedure</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">account_number = guide_account.find(</span><span class="s3">f'ans:cabecalhoGuia/ans:numeroGuiaPrestador'</span><span class="s2">, </span><span class="s1">ans_prefix).text</span>
            <span class="s1">message = </span><span class="s3">f'Procedimento: </span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">} </span><span class="s3">não foi encontrado na conta: </span><span class="s2">{</span><span class="s1">account_number</span><span class="s2">}\n</span><span class="s3">'</span>
            <span class="s1">not_found_items.append(message)</span>


<span class="s2">def </span><span class="s1">getExecutedProcedures(guide_account: Et.Element):</span>
    <span class="s1">account_executed_procedures = guide_account.find(</span><span class="s3">'ans:procedimentosExecutados'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s2">return </span><span class="s1">account_executed_procedures</span>


<span class="s2">def </span><span class="s1">getExpenseProcedures(guide_account: Et.Element):</span>
    <span class="s1">account_expense_procedures = guide_account.find(</span><span class="s3">'ans:outrasDespesas'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s2">return </span><span class="s1">account_expense_procedures</span>


<span class="s2">def </span><span class="s1">searchSpecifiedProcedureInExecutedOrExpensesProcedures(executed_procedures: Et.Element</span><span class="s2">, </span><span class="s1">expense_procedures: Et.Element):</span>
    <span class="s2">if </span><span class="s1">Et.iselement(executed_procedures):</span>
        <span class="s1">specified_procedure = searchSpecifiedProcedureCodeInExecutedProcedures(executed_procedures)</span>
        <span class="s2">if </span><span class="s1">len(specified_procedure) &gt; </span><span class="s4">0</span><span class="s1">:</span>
            <span class="s2">return </span><span class="s1">specified_procedure</span>

    <span class="s2">if </span><span class="s1">Et.iselement(expense_procedures):</span>
        <span class="s1">specified_procedure = searchSpecifiedProcedureCodeInExpenseProcedures(expense_procedures)</span>
        <span class="s2">if </span><span class="s1">len(specified_procedure) &gt; </span><span class="s4">0</span><span class="s1">:</span>
            <span class="s2">return </span><span class="s1">specified_procedure</span>


<span class="s2">def </span><span class="s1">searchSpecifiedProcedureCodeInExecutedProcedures(procedures: Et.Element):</span>
    <span class="s0"># SEARCH IN ALL EXECUTED PROCEDURES FOR THE SPECIFIED PROCEDURE CODE</span>
    <span class="s1">procedure_data = procedures.iterfind(</span><span class="s3">f'.//ans:procedimento[ans:codigoProcedimento=&quot;</span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">}</span><span class="s3">&quot;]..'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s1">procedure_data = list(procedure_data)</span>
    <span class="s2">return </span><span class="s1">procedure_data</span>


<span class="s2">def </span><span class="s1">searchSpecifiedProcedureCodeInExpenseProcedures(procedures):</span>
    <span class="s0"># SEARCH IN ALL EXECUTED PROCEDURES FOR THE SPECIFIED PROCEDURE CODE</span>
    <span class="s1">procedure_data = procedures.iterfind(</span><span class="s3">f'.//ans:servicosExecutados[ans:codigoProcedimento=&quot;</span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">}</span><span class="s3">&quot;].'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s1">procedure_data = list(procedure_data)</span>
    <span class="s2">return </span><span class="s1">procedure_data</span>


<span class="s2">def </span><span class="s1">alterTableType(specified_procedure_data: Et.ElementTree):</span>
    <span class="s1">tag_table_type = specified_procedure_data.find(</span><span class="s3">'ans:codigoTabela'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s2">if not </span><span class="s1">Et.iselement(tag_table_type):</span>
        <span class="s1">tag_table_type = specified_procedure_data.find(</span><span class="s3">'ans:procedimento/ans:codigoTabela'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s2">if </span><span class="s1">new_table_type != </span><span class="s3">'' </span><span class="s2">and </span><span class="s1">new_table_type != tag_table_type.text:</span>
        <span class="s1">tag_table_type.text = str(new_table_type)</span>
        <span class="s1">altered_data = </span><span class="s3">'tipo de tabela'</span>
        <span class="s1">prepareAlterationLogLines(altered_data</span><span class="s2">, </span><span class="s1">table_type</span><span class="s2">, </span><span class="s1">new_table_type)</span>


<span class="s2">def </span><span class="s1">alterUnityMeasure(specified_procedure_data: Et.ElementTree):</span>
    <span class="s1">tag_unity_measure = specified_procedure_data.find(</span><span class="s3">'ans:unidadeMedida'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s2">if </span><span class="s1">new_unity_measure != </span><span class="s3">'' </span><span class="s2">and </span><span class="s1">new_unity_measure != tag_unity_measure.text:</span>
        <span class="s1">tag_unity_measure.text = tag_unity_measure.text.replace(str(unity_measure)</span><span class="s2">, </span><span class="s1">str(new_unity_measure)).rjust(</span>
            <span class="s1">len(tag_unity_measure.text)</span><span class="s2">, </span><span class="s3">'0'</span><span class="s1">)</span>

        <span class="s1">altered_data = </span><span class="s3">'unidade de medida'</span>
        <span class="s1">prepareAlterationLogLines(altered_data</span><span class="s2">, </span><span class="s1">unity_measure</span><span class="s2">, </span><span class="s1">new_unity_measure)</span>


<span class="s2">def </span><span class="s1">alterProcedureCode(specified_procedure_data):</span>
    <span class="s2">if </span><span class="s1">guide_type == </span><span class="s3">'SADT'</span><span class="s1">:</span>
        <span class="s1">tag_procedure_code = specified_procedure_data.find(</span><span class="s3">'ans:codigoProcedimento'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s2">elif </span><span class="s1">guide_type == </span><span class="s3">'HOSPITALIZATION'</span><span class="s1">:</span>
        <span class="s1">tag_procedure_code = specified_procedure_data.find(</span><span class="s3">'ans:procedimento/ans:codigoProcedimento'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s2">if </span><span class="s1">new_procedure_code != </span><span class="s3">'' </span><span class="s2">and </span><span class="s1">new_procedure_code != tag_procedure_code.text:</span>
        <span class="s1">tag_procedure_code.text = tag_procedure_code.text.replace(str(procedure_code)</span><span class="s2">, </span><span class="s1">str(new_procedure_code))</span>
        <span class="s1">altered_data = </span><span class="s3">'código do procedimento'</span>
        <span class="s1">prepareAlterationLogLines(altered_data</span><span class="s2">, </span><span class="s1">procedure_code</span><span class="s2">, </span><span class="s1">new_procedure_code)</span>


<span class="s2">def </span><span class="s1">prepareAlterationLogLines(altered_data: str</span><span class="s2">, </span><span class="s1">old: str</span><span class="s2">, </span><span class="s1">new: str):</span>
    <span class="s2">if </span><span class="s1">guide_number != </span><span class="s3">''</span><span class="s1">:</span>
        <span class="s1">log_line = </span><span class="s3">f'Número da conta:</span><span class="s2">{</span><span class="s1">guide_number</span><span class="s2">} </span><span class="s3">Procedimento:</span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">} {</span><span class="s1">altered_data</span><span class="s2">}</span><span class="s3">:</span><span class="s2">{</span><span class="s1">old</span><span class="s2">} </span><span class="s3">alterado para:</span><span class="s2">{</span><span class="s1">new</span><span class="s2">} </span><span class="s3">'</span>
        <span class="s1">alteration_log_list.append(log_line)</span>

    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">log_line = </span><span class="s3">f'Procedimento:</span><span class="s2">{</span><span class="s1">procedure_code</span><span class="s2">} {</span><span class="s1">altered_data</span><span class="s2">}</span><span class="s3">:</span><span class="s2">{</span><span class="s1">old</span><span class="s2">} </span><span class="s3">alterado para:</span><span class="s2">{</span><span class="s1">new</span><span class="s2">}</span><span class="s3">'</span>
        <span class="s1">alteration_log_list.append(log_line)</span>


<span class="s2">def </span><span class="s1">wasAltered():</span>
    <span class="s2">global </span><span class="s1">control_var</span>
    <span class="s1">control_var += </span><span class="s4">1</span>


<span class="s2">def </span><span class="s1">doValueAlteration(guide_accounts):</span>
    <span class="s0"># READ WORKSHEET TABLE OF VALUE ALTERATION</span>
    <span class="s1">table_reviews = pd.read_excel(</span><span class="s3">&quot;Sources/Teste.xlsx&quot;</span><span class="s2">, </span><span class="s1">sheet_name=</span><span class="s3">'2'</span><span class="s2">, </span><span class="s1">dtype=str</span><span class="s2">,</span>
                                  <span class="s1">keep_default_na=</span><span class="s2">False</span><span class="s1">)</span>

    <span class="s0"># FOR EACH REVIEW LINE IN TABLE, IF THE CONDITIONS IS ATTENDED DOES ALTERATIONS</span>
    <span class="s2">for </span><span class="s1">review_line </span><span class="s2">in </span><span class="s1">table_reviews.values:</span>
        <span class="s1">prepareValueAlteration(review_line)</span>

        <span class="s2">for </span><span class="s1">account </span><span class="s2">in </span><span class="s1">guide_accounts:</span>
            <span class="s1">specified_procedure_data = getSpecifiedProcedureData(account)</span>
            <span class="s2">if </span><span class="s1">isinstance(specified_procedure_data</span><span class="s2">, </span><span class="s1">list):</span>
                <span class="s2">for </span><span class="s1">procedure </span><span class="s2">in </span><span class="s1">specified_procedure_data:</span>
                    <span class="s1">alterValues(procedure</span><span class="s2">, </span><span class="s1">account)</span>
                    <span class="s1">wasAltered()</span>


<span class="s2">def </span><span class="s1">prepareValueAlteration(review_line: list):</span>
    <span class="s2">global </span><span class="s1">guide_number</span><span class="s2">, </span><span class="s1">procedure_code</span><span class="s2">, </span><span class="s1">unitary_value</span><span class="s2">, </span><span class="s1">new_unitary_value</span>
    <span class="s1">[guide_number</span><span class="s2">, </span><span class="s1">procedure_code</span><span class="s2">, </span><span class="s1">unitary_value</span><span class="s2">, </span><span class="s1">new_unitary_value] = returnReviewLine(review_line</span><span class="s2">, </span><span class="s3">'values'</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">alterValues(specified_procedure_data: Et.ElementTree</span><span class="s2">, </span><span class="s1">account: Et.ElementTree):</span>
    <span class="s0"># GET PROCEDURE UNITARY VALUE</span>
    <span class="s1">unitary_value_tag = specified_procedure_data.find(</span><span class="s3">'ans:valorUnitario'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s0"># IF PROCEDURE VALUE IS THE SAME AS READED DOES ALTERATIONS</span>
    <span class="s2">if </span><span class="s1">unitary_value_tag.text == </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(unitary_value)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span><span class="s1">:</span>
        <span class="s1">executed_quantity = specified_procedure_data.find(</span><span class="s3">'ans:quantidadeExecutada'</span><span class="s2">, </span><span class="s1">ans_prefix).text</span>
        <span class="s1">procedure_total_value_tag = specified_procedure_data.find(</span><span class="s3">'ans:valorTotal'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

        <span class="s0"># STORAGE THE OLD PROCEDURE TOTAL VALUE</span>
        <span class="s1">old_procedure_total_value = procedure_total_value_tag.text</span>

        <span class="s0"># ALTER THE PROCEDURE UNITARY VALUE</span>
        <span class="s1">unitary_value_tag.text = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(new_unitary_value)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>

        <span class="s0"># CALCULATE THE NEW TOTAL VALUE OF PROCEDURE AND ALTER</span>
        <span class="s1">new_procedure_total_value = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(unitary_value_tag.text) * float(executed_quantity)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>
        <span class="s1">procedure_total_value_tag.text = new_procedure_total_value</span>

        <span class="s0"># IF OLD VALUE LARGER THAN NEW VALUE</span>
        <span class="s2">if </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(old_procedure_total_value)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">' </span><span class="s1">&gt; </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(new_procedure_total_value)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span><span class="s1">:</span>
            <span class="s1">value_difference = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(old_procedure_total_value) - float(procedure_total_value_tag.text)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">value_difference = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(new_procedure_total_value) - float(old_procedure_total_value)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>

        <span class="s1">altered_data = </span><span class="s3">'valor unitário'</span>
        <span class="s1">prepareAlterationLogLines(altered_data</span><span class="s2">, </span><span class="s1">unitary_value</span><span class="s2">, </span><span class="s1">new_unitary_value)</span>
        <span class="s1">recalculateAllTotalValues(value_difference</span><span class="s2">, </span><span class="s1">account)</span>


<span class="s2">def </span><span class="s1">recalculateAllTotalValues(difference: str</span><span class="s2">, </span><span class="s1">account: Et.ElementTree):</span>
    <span class="s0"># GET ACCOUNT TOTAL VALUES TAGS</span>
    <span class="s1">account_total_values_tag = account.find(</span><span class="s3">'ans:valorTotal'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>
    <span class="s1">general_total_values_tag = account_total_values_tag.find(</span><span class="s3">'ans:valorTotalGeral'</span><span class="s2">, </span><span class="s1">ans_prefix)</span>

    <span class="s2">for </span><span class="s1">total_value </span><span class="s2">in </span><span class="s1">account_total_values_tag:</span>
        <span class="s0"># IF TOTAL VALUE LARGER THAN DIFFERENCE VALUE ALTER</span>
        <span class="s2">if </span><span class="s1">float(total_value.text) &gt; float(difference):</span>
            <span class="s1">total_value.text = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(total_value.text) - float(difference)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>
            <span class="s1">general_total_values_tag.text = </span><span class="s3">f'</span><span class="s2">{</span><span class="s1">float(general_total_values_tag.text) - float(difference)</span><span class="s2">:</span><span class="s3">.2f</span><span class="s2">}</span><span class="s3">'</span>
            <span class="s2">break</span>


<span class="s2">def </span><span class="s1">waitSave():</span>
    <span class="s2">for </span><span class="s1">button </span><span class="s2">in </span><span class="s1">(alteration_button</span><span class="s2">, </span><span class="s1">value_alteration_check_button</span><span class="s2">,</span>
                   <span class="s1">data_alteration_check_button</span><span class="s2">, </span><span class="s1">check_button_information):</span>
        <span class="s1">button.destroy()</span>


<span class="s2">def </span><span class="s1">saveGuideAfterAlterations():</span>
    <span class="s0"># GENERATE NEW HASH</span>
    <span class="s1">generateHash(root_tag)</span>

    <span class="s0"># SAVE ALTERED GUIDE</span>
    <span class="s1">saveFile(guide_path)</span>

    <span class="s0"># GET GUIDE NAME</span>
    <span class="s1">guide_name = os.path.basename(guide_path).split(</span><span class="s3">&quot;_&quot;</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">createLogFile(guide_name)</span>

    <span class="s1">mb.showinfo(message=</span><span class="s3">'Arquivo salvo!'</span><span class="s1">)</span>
    <span class="s1">cancelAlteration()</span>


<span class="s2">def </span><span class="s1">generateHash(root_tag: Et.Element):</span>
    <span class="s2">global </span><span class="s1">new_hash_code</span>
    <span class="s1">root_tag_without_hash_text = removeHashTextFromGuide(root_tag)</span>
    <span class="s1">all_guide_tags = root_tag_without_hash_text.iter()</span>
    <span class="s1">new_hash_code = generateNewHashCode(all_guide_tags)</span>
    <span class="s1">root_tag.find(</span><span class="s3">'ans:epilogo'</span><span class="s2">, </span><span class="s1">ans_prefix).find(</span><span class="s3">'ans:hash'</span><span class="s2">, </span><span class="s1">ans_prefix).text = new_hash_code</span>


<span class="s2">def </span><span class="s1">removeHashTextFromGuide(guide_root_tag: Et.Element):</span>
    <span class="s1">guide_root_tag.find(</span><span class="s3">'ans:epilogo'</span><span class="s2">, </span><span class="s1">ans_prefix).find(</span><span class="s3">'ans:hash'</span><span class="s2">, </span><span class="s1">ans_prefix).text = </span><span class="s3">''</span>
    <span class="s2">return </span><span class="s1">guide_root_tag</span>


<span class="s2">def </span><span class="s1">generateNewHashCode(all_tags: typing.Generator):</span>
    <span class="s1">tags_texts = []</span>
    <span class="s1">unique_line_string = </span><span class="s3">''</span>
    <span class="s0"># FOR EVERY TAG REMOVE LINE BREAKS</span>
    <span class="s2">for </span><span class="s1">tag </span><span class="s2">in </span><span class="s1">all_tags:</span>
        <span class="s1">tags_texts.append(tag.text.replace(</span><span class="s3">&quot;</span><span class="s2">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s3">''</span><span class="s1">))</span>

    <span class="s0"># FOR EVERY TEXT ADD TO UNIQUE LINE</span>
    <span class="s2">for </span><span class="s1">text </span><span class="s2">in </span><span class="s1">tags_texts:</span>
        <span class="s1">unique_line_string += text</span>

    <span class="s0"># CREATE NEW HASH CODE</span>
    <span class="s1">h = hashlib.md5(unique_line_string.encode(</span><span class="s3">'iso-8859-1'</span><span class="s1">))</span>
    <span class="s1">new_code = h.hexdigest()</span>
    <span class="s2">return </span><span class="s1">new_code</span>


<span class="s2">def </span><span class="s1">saveFile(guide_path: str):</span>
    <span class="s1">guide_name = os.path.basename(guide_path).split(</span><span class="s3">&quot;_&quot;</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">path = guide_path.rsplit(</span><span class="s3">'/'</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">output_path = </span><span class="s3">r&quot;C:\Users\elias\Documents\GitHub\python-automatics-data-alterations-in-xml-file\Tests\Output&quot;</span>
    <span class="s1">guide_file.write(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">output_path</span><span class="s2">}</span><span class="s3">/</span><span class="s2">{</span><span class="s1">guide_name</span><span class="s2">}</span><span class="s3">_</span><span class="s2">{</span><span class="s1">new_hash_code</span><span class="s2">}</span><span class="s3">.xml'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">&quot;ISO-8859-1&quot;</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">createLogFile(guide_name: str):</span>
    <span class="s0"># GET ABSOLUTE PATH OF LOGS FOLDER</span>
    <span class="s1">log_folder_path = os.path.abspath(</span><span class="s3">r'Logs'</span><span class="s1">)</span>

    <span class="s0"># IF HAVE A LOG OF SAME GUIDE OPEN LOG LIKE APPEND MODE ELSE CREATE NEW TXT FILE AS LOG</span>
    <span class="s1">log_file = checkIfExistsLogFile(guide_name</span><span class="s2">, </span><span class="s1">log_folder_path)</span>

    <span class="s0"># BEFORE WRITE CHECK IN LOG IF IT HAS REPEATED LINES IN ALTERATION LOG LIST, IF YES REMOVE THEM FROM LIST</span>
    <span class="s1">log_file_readable = open(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">log_folder_path</span><span class="s2">}</span><span class="s3">/</span><span class="s2">{</span><span class="s1">guide_name</span><span class="s2">}</span><span class="s3">.txt'</span><span class="s2">, </span><span class="s3">'r'</span><span class="s1">)</span>

    <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">log_file_readable.readlines():</span>
        <span class="s2">if </span><span class="s1">line.replace(</span><span class="s3">&quot;</span><span class="s2">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s3">''</span><span class="s1">) </span><span class="s2">in </span><span class="s1">alteration_log_list:</span>
            <span class="s1">alteration_log_list.remove(line.replace(</span><span class="s3">&quot;</span><span class="s2">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s3">''</span><span class="s1">))</span>

    <span class="s2">for </span><span class="s1">alteration </span><span class="s2">in </span><span class="s1">alteration_log_list:</span>
        <span class="s1">log_file.write(alteration + </span><span class="s3">'</span><span class="s2">\n</span><span class="s3">'</span><span class="s1">)</span>

    <span class="s1">alteration_log_list.clear()</span>
    <span class="s1">log_file.close()</span>


<span class="s2">def </span><span class="s1">checkIfExistsLogFile(guide_name: str</span><span class="s2">, </span><span class="s1">log_folder_path: str):</span>
    <span class="s2">if </span><span class="s1">os.path.isfile(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">log_folder_path</span><span class="s2">}</span><span class="s3">/</span><span class="s2">{</span><span class="s1">guide_name</span><span class="s2">}</span><span class="s3">.txt'</span><span class="s1">):</span>
        <span class="s1">log_file = open(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">log_folder_path</span><span class="s2">}</span><span class="s3">/</span><span class="s2">{</span><span class="s1">guide_name</span><span class="s2">}</span><span class="s3">.txt'</span><span class="s2">, </span><span class="s3">'a'</span><span class="s1">)</span>

    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">log_file = open(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">log_folder_path</span><span class="s2">}</span><span class="s3">/</span><span class="s2">{</span><span class="s1">guide_name</span><span class="s2">}</span><span class="s3">.txt'</span><span class="s2">, </span><span class="s3">'x'</span><span class="s1">)</span>
        <span class="s1">log_file.write(</span><span class="s3">'---------------------------- LOG DE ALTERAÇÕES ----------------------------</span><span class="s2">\n</span><span class="s3">'</span><span class="s1">)</span>
    <span class="s2">return </span><span class="s1">log_file</span>


<span class="s2">def </span><span class="s1">showNotFoundItems(items: list):</span>
    <span class="s2">if </span><span class="s1">len(items) &gt; </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s1">message = </span><span class="s3">''</span>
        <span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">items:</span>
            <span class="s1">message += item</span>
        <span class="s1">mb.showinfo(</span><span class="s3">'Info'</span><span class="s2">, </span><span class="s1">message)</span>


<span class="s2">def </span><span class="s1">createGui():</span>
    <span class="s2">global </span><span class="s1">frame</span><span class="s2">, </span><span class="s1">generateHashAndSave_button</span><span class="s2">, </span><span class="s1">chooseGuide_button</span>

    <span class="s0"># GUI COLOR CONFIG</span>
    <span class="s1">ctk.set_appearance_mode(</span><span class="s3">'dark'</span><span class="s1">)</span>
    <span class="s1">ctk.set_default_color_theme(</span><span class="s3">'green'</span><span class="s1">)</span>

    <span class="s0"># MAIN WINDOW</span>
    <span class="s1">main_window = ctk.CTk()</span>
    <span class="s1">ctk.CTk.iconbitmap(main_window</span><span class="s2">, </span><span class="s3">r'Resources/icon.ico'</span><span class="s1">)</span>
    <span class="s1">main_window.geometry(</span><span class="s3">'300x260'</span><span class="s1">)</span>
    <span class="s1">main_window.title(</span><span class="s3">'Alterador de Guias TISS'</span><span class="s1">)</span>
    <span class="s1">main_window.eval(</span><span class="s3">'tk::PlaceWindow . center'</span><span class="s1">)</span>
    <span class="s1">main_window.maxsize(</span><span class="s4">300</span><span class="s2">, </span><span class="s4">260</span><span class="s1">)</span>

    <span class="s0"># MAIN FRAME</span>
    <span class="s1">frame = ctk.CTkFrame(main_window)</span>
    <span class="s1">frame.pack(side=</span><span class="s3">'left'</span><span class="s2">, </span><span class="s1">fill=</span><span class="s3">'both'</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">expand=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s0"># DEFAULT BUTTON</span>
    <span class="s1">open_plan_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Abrir planilha'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: openWorksheet())</span>
    <span class="s1">open_plan_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s0"># RELATIVE BUTTONS</span>
    <span class="s1">createRelativeButtons()</span>

    <span class="s2">return </span><span class="s1">main_window</span>


<span class="s2">def </span><span class="s1">createRelativeButtons():</span>
    <span class="s2">global </span><span class="s1">generateHashAndSave_button</span><span class="s2">, </span><span class="s1">chooseGuide_button</span>

    <span class="s1">generateHashAndSave_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Gerar hash'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: generateHashAndSave())</span>
    <span class="s1">generateHashAndSave_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>

    <span class="s1">chooseGuide_button = ctk.CTkButton(frame</span><span class="s2">, </span><span class="s1">text=</span><span class="s3">'Carregar Guia'</span><span class="s2">, </span><span class="s1">command=</span><span class="s2">lambda</span><span class="s1">: openGuide())</span>
    <span class="s1">chooseGuide_button.pack(side=</span><span class="s3">'bottom'</span><span class="s2">, </span><span class="s1">pady=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">padx=</span><span class="s4">5</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">cancelAlteration():</span>
    <span class="s0"># REDEFINE BUTTONS</span>
    <span class="s2">if </span><span class="s3">'control_var' </span><span class="s2">not in </span><span class="s1">globals():</span>
        <span class="s2">for </span><span class="s1">button </span><span class="s2">in </span><span class="s1">(alteration_button</span><span class="s2">, </span><span class="s1">cancel_button</span><span class="s2">, </span><span class="s1">data_alteration_check_button</span><span class="s2">, </span><span class="s1">value_alteration_check_button</span><span class="s2">,</span>
                       <span class="s1">check_button_information):</span>
            <span class="s1">button.destroy()</span>

    <span class="s2">elif </span><span class="s1">control_var &gt; </span><span class="s4">0</span><span class="s1">:</span>
        <span class="s2">for </span><span class="s1">button </span><span class="s2">in </span><span class="s1">(saveGuide_button</span><span class="s2">, </span><span class="s1">cancel_button):</span>
            <span class="s1">button.destroy()</span>

    <span class="s1">createRelativeButtons()</span>


<span class="s0">########################################################################################################################</span>
<span class="s0"># file_path = r&quot;C:\Users\elias\Documents\GitHub\python-automatics-data-alterations-in-xml-file\Tests\00000000000000000090_ba313cac6d8bf136fdc5f46e4fd26fc0.xml&quot;</span>
<span class="s1">file_path = </span><span class="s3">r&quot;C:\Users\elias\Documents\GitHub\python-automatics-data-alterations-in-xml-file\Tests\0001_a5fbec5215f9c66b4e9e7a4814f9c21e.xml&quot;</span>
<span class="s0"># openGuide()</span>
<span class="s0"># doAlterationAction()</span>
<span class="s0"># saveGuideAfterAlterations()</span>
<span class="s0"># generateHashAndSave()</span>

<span class="s1">window = createGui()</span>
<span class="s1">window.mainloop()</span></pre>
</body>
</html>